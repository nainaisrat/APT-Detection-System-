# APT Detection System Configuration File

# Dataset Configuration
dataset:
  cicids2017_path: "data/raw/CICIDS2017"
  nsl_kdd_path: "data/raw/NSL-KDD"
  processed_path: "data/processed"
  test_size: 0.2
  validation_size: 0.1
  random_state: 42

# Feature Engineering
features:
  # Flow-based features
  flow_features:
    - duration
    - protocol_type
    - service
    - flag
    - src_bytes
    - dst_bytes
    - land
    - wrong_fragment
    - urgent
  
  # Statistical features
  statistical_features:
    - count
    - srv_count
    - serror_rate
    - srv_serror_rate
    - rerror_rate
    - srv_rerror_rate
    - same_srv_rate
    - diff_srv_rate
    
  # Behavioral features
  behavioral_features:
    - dst_host_count
    - dst_host_srv_count
    - dst_host_same_srv_rate
    - dst_host_diff_srv_rate
    - dst_host_same_src_port_rate
    - dst_host_srv_diff_host_rate

# Model Configuration
models:
  random_forest:
    n_estimators: 200
    max_depth: 20
    min_samples_split: 5
    min_samples_leaf: 2
    random_state: 42
    n_jobs: -1
    
  lstm:
    units: [128, 64, 32]
    dropout: 0.3
    recurrent_dropout: 0.2
    epochs: 50
    batch_size: 256
    learning_rate: 0.001
    
  xgboost:
    n_estimators: 200
    max_depth: 10
    learning_rate: 0.1
    subsample: 0.8
    colsample_bytree: 0.8
    
  ensemble:
    voting: 'soft'
    weights: [0.3, 0.4, 0.3]  # RF, LSTM, XGBoost

# APT Detection Parameters
apt_detection:
  # Kill Chain Stages
  kill_chain_stages:
    - reconnaissance
    - weaponization
    - delivery
    - exploitation
    - installation
    - command_and_control
    - actions_on_objectives
    
  # Detection thresholds
  thresholds:
    anomaly_score: 0.7
    confidence_threshold: 0.85
    suspicious_activity_window: 300  # seconds
    
  # Behavioral patterns
  patterns:
    lateral_movement_indicators:
      - multiple_failed_logins
      - privilege_escalation_attempts
      - unusual_port_scanning
      - abnormal_data_transfer
      
    data_exfiltration_indicators:
      - large_outbound_transfers
      - encrypted_traffic_spikes
      - unusual_dns_queries
      - connection_to_known_c2_servers

# MITRE ATT&CK Configuration
mitre_attack:
  api_url: "https://raw.githubusercontent.com/mitre/cti/master/enterprise-attack/enterprise-attack.json"
  update_interval: 86400  # Update every 24 hours
  
  # Tactics to monitor
  tactics:
    - initial-access
    - execution
    - persistence
    - privilege-escalation
    - defense-evasion
    - credential-access
    - discovery
    - lateral-movement
    - collection
    - command-and-control
    - exfiltration
    - impact

# Dashboard Configuration
dashboard:
  title: "APT Detection System - Real-time Monitoring"
  refresh_interval: 5  # seconds
  port: 8501
  host: "localhost"
  
  # Visualization settings
  plots:
    attack_timeline: true
    kill_chain_progress: true
    threat_heatmap: true
    model_performance: true
    alert_severity: true

# Logging Configuration
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/apt_detection.log"
  max_bytes: 10485760  # 10MB
  backup_count: 5

# Alert Configuration
alerts:
  email:
    enabled: false
    smtp_server: "smtp.gmail.com"
    smtp_port: 587
    sender: "your_email@gmail.com"
    recipients: []
    
  severity_levels:
    critical: 0.9
    high: 0.7
    medium: 0.5
    low: 0.3

# Performance Monitoring
performance:
  track_metrics: true
  save_predictions: true
  save_interval: 3600  # Save metrics every hour
  
# Output Configuration
output:
  models_path: "results/models"
  metrics_path: "results/metrics"
  reports_path: "results/reports"
  predictions_path: "results/predictions"
